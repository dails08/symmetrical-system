<div class="crossDrop" cdkDropListGroup>
    <div class="slayerCards">
        @for (player of players | keyvalue; track player.value.id) {
            <div cdkDropList class="playerCard"
            [id]="player.value.id"
            (cdkDropListDropped)="dropAssign($event)">
                <div class="playerBar">
                    <p>{{player.value.displayName}} ({{player.value.id}})</p>
                    <button (click)="unassignSlayer(player.value.id)">Unassign</button>
                    <div class="chekhov">
                        <p>Chekhov:</p>
                        <button  (click)="alterChekhovPoints(player.key, player.value.chekhovPoints - 1)">-</button>
                        <p>{{player.value.chekhovPoints}}</p>
                        <button  (click)="alterChekhovPoints(player.key, player.value.chekhovPoints + 1)">+</button>
                    </div>
                </div>
                <app-gm-slayer-summary   [player]="player.value" [playerIx]="player.key" class="individualCard"></app-gm-slayer-summary>
                <ng-template *cdkDragPlaceholder></ng-template>
            </div>
        }
    </div>

    <div class="bottomHalf">
      <div class="controlsSection">
        <div class="sectionLabel">
          <p>Roster</p>
        </div>
        <div class="sectionContent">
          <div class="rosterLists">
          <p>Alive</p>
          <div cdkDropList id="rosterList" class="roster">
              @for (slayer of roster; track slayer.id) {
                  <div cdkDrag [cdkDragData]="slayer" class="slayer">
                      <p>{{slayer.name}}, {{slayer.class}}</p>
                  </div>
              }
          </div>

          <p>KIA</p>
          <div cdkDropList
          (cdkDropListDropped)="dropKill($event)"
          id="kiaList"
          class="roster">

          @for (slayer of kia; track slayer.id) {
              <div class="slayer" >
                  <p>{{slayer.name}}, {{slayer.class}}</p>
              </div>
          }
          </div>
        </div>
        <div class="characterCreation">
          <input matInput #newCharacterName placeholder="Slayer Name" >
          <button matButton (click)="createNew('blade', newCharacterName.value)">Add Blade</button>
          <button matButton (click)="createNew('gunslinger', newCharacterName.value)">Add Gunslinger</button>
          <button matButton (click)="createNew('arcanist', newCharacterName.value)">Add Arcanist</button>
          <button matButton (click)="createNew('tactician', newCharacterName.value)">Add Tactician</button>
        </div>
        </div>
      </div>

      <div class="controlsSection">
        <div class="sectionLabel">
          <p>Recent Rolls</p>
        </div>
        <div class="sectionContent">
            <div class="recentRollsDisplay">
              @for (roll of (this.cjs.room | async)?.state?.recentRolls?.toArray(); track roll.rollName){
                <p>{{roll.actor}}:{{roll.rollName}}:{{roll.value}}</p>
              }
            </div>
            <div class="recentRollsControls">
              <input matInput #rollActor placeholder="Actor" >
              <input matInput #rollName placeholder="Name" >
              <input matInput #rollValue placeholder="Value" >
              <input matInput #rollTimes placeholder="Multiple" >
              <button (click)="sendRecentRolls(rollActor.value, rollName.value, rollValue.value, rollTimes.value, 'set')">Set rolls</button>
              <button (click)="sendRecentRolls(rollActor.value, rollName.value, rollValue.value, rollTimes.value, 'add')">Add to rolls</button>
              <button (click)="sendRecentRolls(rollActor.value, rollName.value, rollValue.value, '0', 'set')">Clear rolls</button>
            </div>


        </div>
      </div>


        <div class="saveAndLoad">
            <button (click)="sendSaveCampaign()">Save Campaign</button>
        </div>

        <div class="overlay">
          <button (click)="playAnimation()">Play Animation</button>
        </div>
    </div>

</div>
